#!/bin/bash
#
# initial trusted network settings

case "$1" in
	start)
		iptables -N TRUSTED
		iptables -A INPUT -j TRUSTED
		iptables -A FORWARD -j TRUSTED	
<%- if trustedips.size != 0 then -%>
	<%- trustedips.to_a.each do |net| -%>
	  	iptables -A TRUSTED -s <%= net %> -j ACCEPT	  	
	<% end -%>
<% end -%>  			
		;;
	stop)
		iptables -A INPUT -j TRUSTED
		iptables -A FORWARD -j TRUSTED	
		iptables -F TRUSTED
		iptables -X TRUSTED		
		;;
	restart)
		$0 stop
		$0 start
		;;
esac


